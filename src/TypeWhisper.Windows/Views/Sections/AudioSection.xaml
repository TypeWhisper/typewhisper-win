<UserControl x:Class="TypeWhisper.Windows.Views.Sections.AudioSection"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/UnifiedSettingsStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <StackPanel MaxWidth="500" Margin="24">
            <TextBlock Text="Aufnahme" Style="{StaticResource SectionHeaderStyle}"/>

            <!-- Microphone -->
            <StackPanel Margin="0,0,0,20">
                <TextBlock Text="Mikrofon" Style="{StaticResource LabelStyle}"/>
                <ComboBox ItemsSource="{Binding Settings.Microphones}"
                          DisplayMemberPath="Name"
                          SelectedValuePath="DeviceNumber"
                          SelectedValue="{Binding Settings.SelectedMicrophoneDevice}"
                          Style="{StaticResource InputComboBoxStyle}"
                          ItemContainerStyle="{StaticResource InputComboBoxItemStyle}"
                          HorizontalAlignment="Stretch"/>
                <Button Content="Aktualisieren" Command="{Binding Settings.RefreshMicrophonesCommand}"
                        Style="{StaticResource SecondaryButtonStyle}"
                        HorizontalAlignment="Left" Margin="0,8,0,0"/>
            </StackPanel>

            <!-- Silence Detection -->
            <TextBlock Text="Stille-Erkennung" Style="{StaticResource SectionHeaderStyle}"/>
            <StackPanel Margin="0,0,0,8">
                <CheckBox Style="{StaticResource InputCheckBoxStyle}"
                          Content="Automatisch stoppen bei Stille"
                          IsChecked="{Binding Settings.SilenceAutoStopEnabled}"/>
            </StackPanel>
            <StackPanel Margin="0,0,0,20">
                <TextBlock Text="Sekunden" Style="{StaticResource LabelStyle}"/>
                <TextBox Text="{Binding Settings.SilenceAutoStopSeconds}"
                         Style="{StaticResource InputTextBoxStyle}"
                         Width="100" HorizontalAlignment="Left"/>
            </StackPanel>

            <!-- Audio Ducking -->
            <TextBlock Text="Audio Ducking" Style="{StaticResource SectionHeaderStyle}"/>
            <StackPanel Margin="0,0,0,8">
                <CheckBox Style="{StaticResource InputCheckBoxStyle}"
                          Content="Systemlautstärke während Aufnahme reduzieren"
                          IsChecked="{Binding Settings.AudioDuckingEnabled}"/>
            </StackPanel>
            <StackPanel Margin="0,0,0,8"
                        Visibility="{Binding Settings.AudioDuckingEnabled, Converter={StaticResource BoolToVis}}">
                <TextBlock Style="{StaticResource LabelStyle}"
                           Text="{Binding Settings.AudioDuckingLevel, StringFormat='Lautstärke: {0:P0}'}"/>
                <Slider Minimum="0" Maximum="0.5"
                        TickFrequency="0.05" IsSnapToTickEnabled="True"
                        Value="{Binding Settings.AudioDuckingLevel}"
                        HorizontalAlignment="Stretch"/>
                <TextBlock Text="0% = stumm, 50% = halbe Lautstärke"
                           Style="{StaticResource HintStyle}"/>
            </StackPanel>

            <!-- Media Pause -->
            <TextBlock Text="Medienwiedergabe" Style="{StaticResource SectionHeaderStyle}"/>
            <StackPanel Margin="0,0,0,8">
                <CheckBox Style="{StaticResource InputCheckBoxStyle}"
                          Content="Wiedergabe während Aufnahme pausieren"
                          IsChecked="{Binding Settings.PauseMediaDuringRecording}"/>
                <TextBlock Text="Pausiert laufende Player (Spotify, YouTube, etc.)"
                           Style="{StaticResource HintStyle}"/>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</UserControl>
