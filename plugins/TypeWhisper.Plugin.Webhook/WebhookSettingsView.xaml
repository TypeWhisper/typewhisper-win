<UserControl x:Class="TypeWhisper.Plugin.Webhook.WebhookSettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:TypeWhisper.Plugin.Webhook">
    <StackPanel Margin="0,4">
        <!-- Add Webhook Button -->
        <Button Content="+ Webhook hinzufÃ¼gen" Click="OnAddWebhook" HorizontalAlignment="Left"
                Padding="12,6" Margin="0,0,0,12" />

        <!-- Webhook List -->
        <ItemsControl x:Name="WebhookList">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="4"
                            Padding="12,8" Margin="0,0,0,8">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- Enable Toggle -->
                            <CheckBox Grid.Column="0" Grid.RowSpan="2" VerticalAlignment="Center"
                                      IsChecked="{Binding IsEnabled, Mode=OneWay}"
                                      Checked="OnToggleChanged" Unchecked="OnToggleChanged"
                                      Margin="0,0,8,0" Tag="{Binding Id}" />

                            <!-- Name -->
                            <TextBlock Grid.Column="1" Grid.Row="0" FontWeight="SemiBold"
                                       Text="{Binding Name}" VerticalAlignment="Center" />

                            <!-- Method + URL -->
                            <TextBlock Grid.Column="1" Grid.Row="1" Foreground="Gray" FontSize="12">
                                <Run Text="{Binding HttpMethod, Mode=OneWay}" />
                                <Run Text=" " />
                                <Run Text="{Binding Url, Mode=OneWay}" />
                            </TextBlock>

                            <!-- Profile Filter Info -->
                            <TextBlock Grid.Column="2" Grid.RowSpan="2" VerticalAlignment="Center"
                                       Foreground="Gray" FontSize="12" Margin="8,0"
                                       Text="{Binding ProfileFilter.Count, StringFormat='{}{0} Profile', Mode=OneWay}" />

                            <!-- Edit Button -->
                            <Button Grid.Column="3" Grid.RowSpan="2" Content="Bearbeiten"
                                    Click="OnEditWebhook" Tag="{Binding Id}"
                                    Padding="8,4" Margin="4,0" VerticalAlignment="Center" />

                            <!-- Delete Button -->
                            <Button Grid.Column="4" Grid.RowSpan="2" Content="Entfernen"
                                    Click="OnDeleteWebhook" Tag="{Binding Id}"
                                    Padding="8,4" Margin="4,0" VerticalAlignment="Center" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- Empty State -->
        <TextBlock x:Name="EmptyState" Text="Keine Webhooks konfiguriert."
                   Foreground="Gray" FontStyle="Italic" Margin="0,4,0,12" />

        <!-- Delivery Log -->
        <TextBlock Text="Delivery Log" FontWeight="SemiBold" Margin="0,12,0,8" />

        <ItemsControl x:Name="LogList">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border BorderBrush="#E8E8E8" BorderThickness="0,0,0,1"
                            Padding="4,4" Margin="0,0,0,2">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!-- Success/Failure Icon -->
                            <TextBlock Grid.Column="0" FontSize="12"
                                       VerticalAlignment="Center"
                                       Text="{Binding Success, Converter={x:Static local:BoolToIconConverter.Instance}}" />

                            <!-- Webhook Name -->
                            <TextBlock Grid.Column="1" Text="{Binding WebhookName}"
                                       VerticalAlignment="Center" />

                            <!-- Status Code or Error -->
                            <TextBlock Grid.Column="2" VerticalAlignment="Center"
                                       Foreground="Gray" FontSize="12" Margin="8,0"
                                       Text="{Binding StatusCode}" />

                            <!-- Timestamp -->
                            <TextBlock Grid.Column="3" VerticalAlignment="Center"
                                       Foreground="Gray" FontSize="11"
                                       Text="{Binding Timestamp, StringFormat='{}{0:HH:mm:ss}'}" />
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <TextBlock x:Name="EmptyLogState" Text="Noch keine Zustellungen."
                   Foreground="Gray" FontStyle="Italic" Margin="0,4,0,0" />
    </StackPanel>
</UserControl>
